import{j,c as D,k as Y,l as q}from"./element-plus-df7bc4e3.js";import"./vue-124c939f.js";import{l as c}from"./lscache-deb3809a.js";import{u as z}from"./vue-router-6f09dd9a.js";import{d as A}from"./pinia-0aa78a2b.js";import{r as G,l as H}from"./user.api-57ed7b6b.js";import{m as g}from"./elementComp-e60736a3.js";import{d as J,r as k,a1 as N,o as f,c as w,a as d,a5 as P,b as F,T as u,e as a,Y as h,aC as K,aD as L}from"./@vue-9340bf27.js";import{_ as O}from"./index-53878eac.js";import"./lodash-es-fd932676.js";import"./@element-plus-d6f5acb0.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./@logicflow-922e186c.js";import"./preact-c85490ff.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-1a309c76.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-0225a2a3.js";import"./vue-demi-1a095971.js";import"./axios-d2e6824c.js";import"./mockjs-9bbec717.js";const Q=A("main",{state:()=>({token:"",user_name:"",password:""}),getters:{getToken:m=>m.token},actions:{getInfo(){this.$patch({user_name:c.get(""),password:c.get("token"),token:c.get("token")})}}}),C=m=>(K("data-v-b67998ad"),m=m(),L(),m),W={class:"wh base-h bg-1"},X={class:"content"},Z={class:"form"},ee={class:"left"},se=["onClick"],te=C(()=>d("h3",null,"登陆",-1)),oe=h("登陆"),re=h("重置"),ae={class:"right"},le=["onClick"],ne=C(()=>d("h3",null,"注册",-1)),ue=h("注册"),ie=h("重置"),pe=J({__name:"login",setup(m){const E=z(),p=k(),v=k(!0),_=k(!1),x=()=>{v.value=!0,_.value=!1},I=()=>{v.value=!1,_.value=!0},S=(n,e,s)=>{if(e)s();else return s(new Error("Please input the userName"))},U=(n,e,s)=>{const l=/^1[3456789]\d{9}$/;if(e)if(l.test(e))s();else return s(new Error("Please input the right phone type"));else return s(new Error("Please input the phone"))},$=(n,e,s)=>{if(e==="")s(new Error("Please input the password"));else{if(t.checkPass!==""){if(!p.value)return;p.value.validateField("checkPass",()=>null)}s()}},B=(n,e,s)=>{e===""?s(new Error("Please input the password again")):e!==t.pass?s(new Error("Two inputs don't match!")):s()},t=N({pass:"",checkPass:"",userName:"",phone:""}),V=N({pass:[{validator:$,trigger:"blur"}],checkPass:[{validator:B,trigger:"blur"}],userName:[{validator:S,trigger:"blur"}],phone:[{validator:U,trigger:"blur"}]}),T=async n=>{let{userName:e,pass:s,phone:l}=n;try{const i=await G({user_name:e,password:s,phone:l});g(i.message,"Success!!")}catch(i){const{data:o}=i==null?void 0:i.response;g(o.message,"Error")}},R=async n=>{var l,i;let{userName:e,pass:s}=n;try{const o=await H({user_name:e,password:s});if((l=o==null?void 0:o.result)!=null&&l.token){const{user_name:r,getInfo:M}=Q();c.set("token",(i=o==null?void 0:o.result)==null?void 0:i.token),M(),E.push("/page")}g(o==null?void 0:o.message,"Success!!")}catch(o){const{data:r}=o==null?void 0:o.response;g(r.message,"Error")}},y=n=>{n&&n.validate(e=>{if(e)_.value?(c.set("userName",t.userName),c.set("pass",t.pass),T(t)):R(t);else return console.log("error submit!"),!1})},b=n=>{n&&n.resetFields()};return(n,e)=>{const s=D,l=Y,i=q,o=j;return f(),w("div",W,[d("div",X,[d("div",Z,[d("div",ee,[v.value?(f(),F(o,{key:1,ref_key:"ruleFormRef",ref:p,model:t,"status-icon":"",rules:V,"label-width":"120px",class:"demo-ruleForm"},{default:u(()=>[te,a(l,{label:"账号",prop:"userName"},{default:u(()=>[a(s,{modelValue:t.userName,"onUpdate:modelValue":e[0]||(e[0]=r=>t.userName=r),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),a(l,{label:"密码",prop:"pass"},{default:u(()=>[a(s,{modelValue:t.pass,"onUpdate:modelValue":e[1]||(e[1]=r=>t.pass=r),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(l,null,{default:u(()=>[a(i,{type:"primary",onClick:e[2]||(e[2]=r=>y(p.value))},{default:u(()=>[oe]),_:1}),a(i,{onClick:e[3]||(e[3]=r=>b(p.value))},{default:u(()=>[re]),_:1})]),_:1})]),_:1},8,["model","rules"])):(f(),w("h3",{key:0,onClick:P(x,["stop"])},"登陆",8,se))]),d("div",ae,[_.value?(f(),F(o,{key:1,ref_key:"ruleFormRef",ref:p,model:t,"status-icon":"",rules:V,"label-width":"120px",class:"demo-ruleForm"},{default:u(()=>[ne,a(l,{label:"账号",prop:"userName"},{default:u(()=>[a(s,{modelValue:t.userName,"onUpdate:modelValue":e[4]||(e[4]=r=>t.userName=r),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),a(l,{label:"手机号",prop:"phone"},{default:u(()=>[a(s,{modelValue:t.phone,"onUpdate:modelValue":e[5]||(e[5]=r=>t.phone=r)},null,8,["modelValue"])]),_:1}),a(l,{label:"密码",prop:"pass"},{default:u(()=>[a(s,{modelValue:t.pass,"onUpdate:modelValue":e[6]||(e[6]=r=>t.pass=r),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(l,{label:"密码确认",prop:"checkPass"},{default:u(()=>[a(s,{modelValue:t.checkPass,"onUpdate:modelValue":e[7]||(e[7]=r=>t.checkPass=r),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(l,null,{default:u(()=>[a(i,{type:"primary",onClick:e[8]||(e[8]=r=>y(p.value))},{default:u(()=>[ue]),_:1}),a(i,{onClick:e[9]||(e[9]=r=>b(p.value))},{default:u(()=>[ie]),_:1})]),_:1})]),_:1},8,["model","rules"])):(f(),w("h3",{key:0,onClick:P(I,["stop"])},"注册",8,le))])])])])}}});const Be=O(pe,[["__scopeId","data-v-b67998ad"]]);export{Be as default};
